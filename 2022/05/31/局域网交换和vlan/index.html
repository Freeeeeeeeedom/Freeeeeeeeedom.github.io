<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>局域网交换和vlan | 投降输一半</title><meta name="keywords" content="计算机网络,互联网计算"><meta name="author" content="胡小小小小睿"><meta name="copyright" content="胡小小小小睿"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="局域网交换 与 vlan  网桥和路由器一般是通过软件来完成的，基于操作系统的 交换机是基于硬件的  交换机 交换机基本功能  根据MAC地址建立和维护 交换表（类似于网桥表 将帧切换出接口到目标  对称交换 Symmetric Switching  对称交换可再具有相同带宽的端口之间提供交换连接（10&#x2F;10Mbps or 100&#x2F;100Mbps） 用户尝试访问其他网段"><meta property="og:type" content="article"><meta property="og:title" content="局域网交换和vlan"><meta property="og:url" content="http://little-hurui.cloud/2022/05/31/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2%E5%92%8Cvlan/index.html"><meta property="og:site_name" content="投降输一半"><meta property="og:description" content="局域网交换 与 vlan  网桥和路由器一般是通过软件来完成的，基于操作系统的 交换机是基于硬件的  交换机 交换机基本功能  根据MAC地址建立和维护 交换表（类似于网桥表 将帧切换出接口到目标  对称交换 Symmetric Switching  对称交换可再具有相同带宽的端口之间提供交换连接（10&#x2F;10Mbps or 100&#x2F;100Mbps） 用户尝试访问其他网段"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://s2.loli.net/2022/04/20/lEudvTzOcIBmCiQ.jpg"><meta property="article:published_time" content="2022-05-31T06:28:06.000Z"><meta property="article:modified_time" content="2022-06-01T01:02:35.122Z"><meta property="article:author" content="胡小小小小睿"><meta property="article:tag" content="计算机网络"><meta property="article:tag" content="互联网计算"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://s2.loli.net/2022/04/20/lEudvTzOcIBmCiQ.jpg"><link rel="shortcut icon" href="https://s2.loli.net/2022/04/19/olzB7QMiuGqbjHe.jpg"><link rel="canonical" href="http://little-hurui.cloud/2022/05/31/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2%E5%92%8Cvlan/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css"}},isPhotoFigcaption:!0,islazyload:!1,isAnchor:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"局域网交换和vlan",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2022-06-01 09:02:35"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0!==o){const a=new Date;o=864e5*o,t={value:t,expiry:a.getTime()+o};localStorage.setItem(e,JSON.stringify(t))}},get:function(e){var t=localStorage.getItem(e);if(t){t=JSON.parse(t);const o=new Date;if(!(o.getTime()>t.expiry))return t.value;localStorage.removeItem(e)}}},e.getScript=a=>new Promise((t,e)=>{const o=document.createElement("script");o.src=a,o.async=!0,o.onerror=e,o.onload=o.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(o.onload=o.onreadystatechange=null,t())},document.head.appendChild(o)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};e=saveToLocal.get("theme"),"dark"===e?activateDarkMode():"light"===e&&activateLightMode(),e=saveToLocal.get("aside-status");void 0!==e&&("hide"===e?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/atom.xml" title="投降输一半" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s2.loli.net/2022/04/20/iVOmaCTznfybv2A.jpg" onerror='onerror=null,src="https://s2.loli.net/2022/04/19/zHg7f51jDBVOcR2.jpg"' alt="avatar"></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">126</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">72</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/notes/"><i class="fa-fw fa fa-bold"></i><span> 随笔</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fa fa-book"></i><span> 书单</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://s2.loli.net/2022/04/20/lEudvTzOcIBmCiQ.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">投降输一半</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/notes/"><i class="fa-fw fa fa-bold"></i><span> 随笔</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fa fa-book"></i><span> 书单</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">局域网交换和vlan</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-05-31T06:28:06.000Z" title="发表于 2022-05-31 14:28:06">2022-05-31</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-06-01T01:02:35.122Z" title="更新于 2022-06-01 09:02:35">2022-06-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E4%BA%92%E8%81%94%E7%BD%91%E8%AE%A1%E7%AE%97/">互联网计算</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">6.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>19分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="局域网交换和vlan"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2022/05/31/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2%E5%92%8Cvlan/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/2022/05/31/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2%E5%92%8Cvlan/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="局域网交换-与-vlan">局域网交换 与 vlan</h1><ul><li>网桥和路由器一般是通过软件来完成的，基于操作系统的</li><li>交换机是基于硬件的</li></ul><h1 id="交换机">交换机</h1><h2 id="交换机基本功能">交换机基本功能</h2><ul><li>根据MAC地址建立和维护 交换表（类似于网桥表</li><li>将帧切换出接口到目标</li></ul><h2 id="对称交换-symmetric-switching">对称交换 Symmetric Switching</h2><ul><li><p>对称交换可再具有相同带宽的端口之间提供交换连接（10/10Mbps or 100/100Mbps）</p></li><li><p>用户尝试访问其他网段上的服务器时，可能会导致瓶颈（对称交换可能会导致带宽不足）</p><p><img src="https://s2.loli.net/2022/06/01/c3qhxPfeFDnjTaR.png"></p></li></ul><blockquote><p>多个客户端 向服务器访问的话， 服务器端口流量会比较阻塞</p><p>（在对称切换中，双端的带宽时完全对称的，这是一个瓶颈）</p></blockquote><h2 id="非对称交换-asymmetric-switching">非对称交换 Asymmetric Switching</h2><ul><li><p>通过将带有服务器的网段连接到更高带宽的端口(100 Mbps)，非对称交换(asymmetric switching)减少了服务器上潜在瓶颈的可能性</p></li><li><p>非对称交换需要在交换器中进行内存缓冲</p></li><li><p>非对称交换端口解决对称交换端口中的对称阻塞问题(进一步保证了服务器的稳定实现)</p></li></ul><p><img src="https://s2.loli.net/2022/06/01/4vwEJ7xUBbrTtkM.png"></p><h3 id="内存缓冲">内存缓冲</h3><ol type="1"><li>交换机中存储目标 和 传输数据的内存区域，直到可以将其切换出正确的端口为止。<ol type="1"><li>基于端口(Port)的内存缓冲<ol type="1"><li>数据包存储在每个端口的队列中</li><li>由于目标端口繁忙，一个数据包可能会延迟其他数据包的传输</li><li>其他端口存在不均衡的问题。</li></ol></li><li>共享(Shared)内存缓冲<ol type="1"><li>所有端口共享的公用内存缓冲</li><li>允许将数据包在一个端口上接收并在另一个端口上发送出去，而无需将其更改为其他队列。</li><li>需要自己记录端口的信息</li></ol></li></ol></li><li>发生阻塞的时候，根据情况按照端口或者内存将包缓存下来</li></ol><h2 id="交换方式">交换方式</h2><h3 id="储存转发-store-and-forward-网桥-路由器等通过软件的设备">储存转发 (Store and Forward ,网桥 路由器等通过软件的设备)</h3><ul><li>交换机接受整个帧，最后将其计算为CRC，然后再将其发送到目的地</li><li>接受后，校验，正确再发送</li></ul><h3 id="cut-through-直通">Cut through 直通</h3><ol type="1"><li>转发会增加延迟，通过使用直通切换方法可以减少</li><li>快速转发切换：仅在立即转发帧之前侦察目标MAC（只看到帧的目的地址就转发，不看帧的后面部分）</li></ol><h3 id="segment-free-switching-无碎片转发">Segment free Switching 无碎片转发</h3><ol type="1"><li><p>​ 碎片释放：在转发帧之前读取前64个字典以减少错误，避免碰撞和帧碎片</p></li><li><p>Example：（三种不同查看方式）</p><p><img src="https://s2.loli.net/2022/06/01/NfZa1IdQKisUcGT.png"></p></li></ol><h2 id="第二层交换机">第二层交换机</h2><p><img src="https://s2.loli.net/2022/06/01/CWj3uywt67zIBqk.png"></p><ul><li>大规模集成电路，保证链路效率，低时延，低成本</li><li>有一个MAC地址</li></ul><h2 id="第三层交换机">第三层交换机</h2><p><img src="https://s2.loli.net/2022/06/01/Uiefl85qr93CL2I.png"></p><ol type="1"><li>基于硬件的帧转发机制</li><li>较高的帧转发性能</li><li>较高速的计算</li><li>低延迟</li><li>流控制</li><li>安全性更高</li><li>对数据流进行路由，生成MAC和IP的映射</li></ol><p>MAC地址过来的时候直接根据表从第二层进行通过</p><h2 id="第四层交换机">第四层交换机</h2><p><img src="https://s2.loli.net/2022/06/01/vo56H8dq1xaUENp.png"></p><ol type="1"><li>数据段在数据报里面，数据报在数据帧里面</li><li>只有交换机可以看到数据帧的数据部分的首部</li><li>可以根据端口主机的应用特点进行一定的流量控制</li><li>和Net OS是不一样的，没有那么智能</li><li>识别到前80个字节的数据报长度，对指定应用进行管理</li></ol><h2 id="多层交换机总结">多层交换机总结</h2><p><img src="https://s2.loli.net/2022/06/01/t5EiJwNZRDMnrAG.png"></p><ol type="1"><li>一般我们只是用二层交换机</li><li>交换机可以简单识别第三层和第四层信息</li></ol><h1 id="生成树协议stp-the-spanning-tree-protocol">生成树协议(STP, The Spanning-Tree Protocol)</h1><h2 id="回路">回路</h2><ol type="1"><li>出于各种原因，网络中可能会出现<strong>环路</strong><ol type="1"><li>通常，网络中的环路是故意(deliberate)提供冗余的结果。</li><li>也可能由于配置错误而发生:在桥接网络中，环路可能是绝对灾难性的两个主要原因：<ol type="1"><li>广播回路(广播风暴)，没有TTL</li><li>路由表的错误</li></ol></li></ol></li><li>往往是<strong>第二层交换机</strong>的冗余导致的桥回路。</li><li>接入层到核心层的接入往往<strong>要有冗余</strong>，这个区域是主干网(backbone)</li></ol><h2 id="冗余造成了路由回路">冗余造成了路由回路</h2><p><img src="https://s2.loli.net/2022/06/01/nQlU3ADuLiImfg9.png"></p><ul><li>设备通过backbone和远端设备进行链接</li></ul><h2 id="第二层路由回路">第二层路由回路</h2><ol type="1"><li>广播和第2层循环可能是危险的组合。</li><li>以太网帧没有TTL字段</li><li>以太网帧开始循环后，它可能会继续下去，直到有人关闭其中一台交换机或断开链路为止(外部条件)</li><li>交换机将抖动(flip flop)主机A的桥接表条目(创建极高的CPU利用率)。</li><li>消耗CPU和内存</li></ol><h3 id="第二层路由回路-泛洪单播帧">第二层路由回路-泛洪单播帧</h3><p><img src="https://s2.loli.net/2022/06/01/d9BDfXaGNx4wKsc.png"></p><ul><li>过一段时间CAT-1和CAT-2没有收到Host-B的信息，删除表中的对应记录</li><li>在这之后，Host A发送给Host B信息，然后在CAT-1和CAT-2之间进行循环</li></ul><h2 id="生成树协议-综述">生成树协议 综述</h2><ol type="1"><li>生成树协议的元素<ol type="1"><li>主要功能：在<strong>交换/桥接网络</strong>中允许<strong>冗余路径</strong>，而不会因环路的影响而引起延迟。</li><li>STP通过计算<strong>稳定的生成树</strong>网络拓扑来防止环路</li><li><strong>生成树帧</strong>(称为桥协议数据单元-BPDU)用于确定生成树拓扑</li></ol></li><li>在正常情况下禁用一些端口来防止出现冗余</li></ol><h3 id="stp决策顺序seqence">STP决策顺序(Seqence)</h3><ol type="1"><li>生成树始终使用相同的四步决策序列：<ol type="1"><li>在拓扑里面最低的root BID(网桥标识)</li><li>找到 Root bridgh的最低路径成本</li><li>每个路径都会选择一个最低BID的sender 这个是针对一个链路的，详见例子</li><li>每个路径再指定一个最低的ID端口</li></ol></li></ol><h3 id="bpdus-bridge-protocol-data-unit">BPDUs (Bridge Protocol Data Unit)</h3><ol type="1"><li>BPDU是交换机之间的流量；它们不承载最终用户(end-user)流量。</li><li>STP建立一个称为<strong>根网桥的根节点</strong>，生成的树源自根桥。</li><li>不属于最短路径树的冗余连接将被阻止。(block 端口，不转发，但是接收)</li><li>在阻塞的链接上收到的数据帧将被丢弃。</li><li>交换机发送的允许形成无环逻辑拓扑的消息是BPDU</li></ol><p><img src="https://s2.loli.net/2022/06/01/T9cYgnlLaqm8esF.png"></p><ul><li>BPDU里面包含几个字段标识协议、版本、数据类型、标志等，记录它认可的Root BID(类似OSPF)、到BID最小的代价、发送的交换机的ID、从哪个端口发送</li><li>和OSPF不一样的:不一定以自己为根</li><li>这样在选举之后，冗余链路就被屏蔽掉了</li></ul><h3 id="stp的bpdu帧">STP的BPDU帧</h3><p><img src="https://s2.loli.net/2022/06/01/PdnXvft7VMC6AcT.png">注意前四个是很有意义的</p><ul><li>默认交换机每2s发送一次BPDU</li><li>主要是维护最短的路径</li><li>接收到BPDU帧的时候，会比较根ID，计算，如果更优则接受，反之则不接受。</li><li>经过一段时间的传递后会全局稳定</li></ul><h3 id="bridge-identificationbid">Bridge Identification/BID</h3><ol type="1"><li>网桥ID(BID)：8个字节(2 + 6)<ol type="1"><li>高阶BID子字段(2个字节)：网桥优先级<ol type="1"><li>216个可能的值：0-65,535(默认值：32,768)</li><li>通常以十进制格式表示</li></ol></li><li>低阶子字段(6个字节)：分配给交换机的MAC地址，以十六进制格式表示</li></ol></li><li>STP成本值：成本越低越好</li></ol><h3 id="选举根交换机">选举根交换机</h3><ol type="1"><li>交换机通过查找具有<strong>最低BID</strong>的交换机(通常称为根战争)来选择单个根交换机。</li><li>如果所有交换机都使用默认的网桥优先级32768，则最低的MAC地址将作为平局。</li><li>配置优先级来调整根桥</li></ol><h2 id="路径代价-cost">路径代价 Cost</h2><p><img src="https://s2.loli.net/2022/06/01/DyS54QtwOChjLPl.png"></p><ol type="1"><li>桥梁使用成本的概念来评估它们与其他桥梁的距离。</li><li>和OSPF算法相同的，这个标准是比较合适的，比之前OSPF要新，用固定的数值除以带宽来获得代价</li></ol><h2 id="five-stp-states-5个stp状态">Five STP States 5个STP状态</h2><ol type="1"><li>通过根据策略配置每个端口来建立状态</li><li>然后，STP根据流量模式(traffic Patterns)和潜在环路(Protential Loops)修改状态</li><li>STP状态的默认顺序为：<ol type="1"><li>阻塞:没有转发帧，听到了BPDU</li><li>监听:不转发任何帧，监听数据帧(确定自己可以参加的交换)，也会发送一些数据帧表示自己状态变了</li><li>学习:不转发帧，学习地址</li><li>转发:转发帧，学习地址</li><li>禁用:没有转发帧，没有听到BPDU</li></ol></li></ol><p><img src="https://s2.loli.net/2022/06/01/AlISN9e4Li7pt3b.png"></p><blockquote><p>STP过程：Blocking -&gt; 20s Listening -&gt; 15s Learning -&gt; 15s Fowarding或者Disabled</p></blockquote><p><img src="https://s2.loli.net/2022/06/01/E16DpXngofWqYwF.png"></p><p><img src="https://s2.loli.net/2022/06/01/75O6iZqpBTGhbIP.png"></p><ul><li>2s可以调整</li><li>老化时间:保存的时间</li></ul><h2 id="初始stp收敛">初始STP收敛</h2><ol type="1"><li>当网络首次启动时，所有网桥都会混合使用BPDU信息来泛洪网络。(开始泛洪BPDU信息)</li><li>立即，他们应用决策序列，允许他们BPDU进行PK，然后选择出来ROOT，从而形成整个网络的单个生成树</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(Step 1) 根交换机决定：选择一个根桥作为该网络的中心点</span><br><span class="line">(Step 2) 选择根端口：所有剩余的网桥都会计算出一组根端口</span><br><span class="line">(Step 3) 选择指定端口：其余所有网桥计算一组指定端口</span><br></pre></td></tr></table></figure><ul><li>Root switch针对一个特定的交换机</li><li>根端口针对一个交换机</li><li>指定端口对应链路</li></ul><h3 id="步骤1根交换机决定">步骤1：根交换机决定</h3><ol type="1"><li>宣布自己为根</li><li>检查端口上收到的所有BPDU以及将在该端口上发送的BPDU</li><li>对于每个到达的BPDU，如果其值小于为端口保存的现有BPDU</li><li>旧值被替换</li><li>BPDU的发送者被接受为新的根</li></ol><p><img src="https://s2.loli.net/2022/06/01/kZWUSDaL9GiCwvz.png"></p><ul><li>BC收到后将根修改为A</li><li>比如在BC链路中，B的MAC地址比较小，作为链路的Sender BID，这个port是指定端口</li></ul><h3 id="步骤2选择根端口">步骤2：选择根端口</h3><ol type="1"><li>每个非根桥必须选择一个根端口。<ol type="1"><li>桥的根端口是最接近根桥的端口。</li><li>根路径成本是到根网桥的所有链接的累积(cumulative)成本。</li></ol></li><li>STP成本随着在端口上接收到BPDU而增加，而不是随着它们从端口发送出去而增加</li></ol><p><img src="https://s2.loli.net/2022/06/01/7gdsQ1JRKYHW5ZA.png"></p><blockquote><p>B会把上面一个端口做为Root Port，虽然两个可达，但是上面一个更快，C也是同样</p></blockquote><h3 id="步骤3选择网段的指定端口i">步骤3：选择网段的指定端口(I)</h3><ol type="1"><li>每个网段都有一个指定的端口：充当单个网桥/交换机端口，该端口既向该网段又向根网桥发送流量，也从该网段和根网桥接收流量。</li><li>包含给定网段的指定端口的网桥/交换机称为该网段的指定网桥。</li><li>所有网桥/交换机将阻止它们上未指定的端口，根网桥上的每个活动端口都将成为指定端口</li><li>每个链路只有一个指定端口，一旦选定其他就block了</li></ol><p><img src="https://s2.loli.net/2022/06/01/JCz9tV2W6seKpYq.png"></p><ul><li>BC之间的，左边是指定端口(BID小)</li><li>MAC地址唯一的</li><li>Root Port都是上面的</li></ul><p><img src="https://s2.loli.net/2022/06/01/xF6yLAMRw7Jo5sY.png"></p><ul><li>AB和AC之间的链路的指定端口是A上面的端口</li></ul><h1 id="vlan-virtual-local-area-network-虚拟局域网">VLAN (Virtual Local Area Network 虚拟局域网)</h1><h2 id="为什么引入vlan">为什么引入VLAN？</h2><ul><li>传统的局域网使用的是集线器（Hub)，Hub只有一根总线，一根总线就是一个冲突域。所以传统的局域网是一个扁平的网络，一个局域网属于同一个冲突域。<strong>任何一台主机</strong>发出的报文都会被同一冲突域中的所有其他机器接收到。</li><li>后来，组网时使用<strong>交换机代替集线器</strong>，每个端口可以看成是一根单独的总线，冲突域缩小到每个端口，使得网络发送单播报文的效率大大提高，与此同时极大地提高了二层网络的性能。</li><li>但是假如一台主机发出广播报文，连接在交换机的所有设备仍然可以接收到该广播信息，通常把广播报文所能传输的范围称为广播域。交换机在传递广播报文的时候依然要将广播报文复制多份，发送到网络的各个角落。所以随着<strong>网络规模的扩大</strong>，网络中的广播报文越来越多，严重<strong>影响网络性能</strong>，这就是所谓的广播风暴的问题。由干交换机二层网络工作原理的限制，交换机对广播风暴的问题无能为力。为了提高网络效率，一般需要将网络进行分段:<strong>把一个大的广播域划分成几个小的广播域</strong>。</li><li>过去往往通过路由器对网络进行分段，这样可以使得广播报文的发送范围大大减小，这种方案解决了广播风暴的问题，但用路由器是在网络层上分段将网络隔离的，网络规划复杂,组网方式不灵活，并且大大增加了管理维护的难度。作为替代的LAN分段方法，虚拟局域网(VLAN）就出现了，专门用来<strong>解决大型的二层网络环境</strong>面临的问题。</li></ul><h2 id="vlan可以不通过路由器就隔离广播域吗">VLAN可以不通过路由器就隔离广播域吗？</h2><ul><li>虚拟局域网（VLAN) 逻辑上把<strong>网络资源</strong>和<strong>网络用户</strong>按照一定的原则进行划分，把一个物理上实际的网络划分成多个小的逻辑的网络。这些小的逻辑的网络形成各自的广播域，也就是虚拟局域网VLAN。</li><li>从下图中可以看出，一共有3个虚拟局域网，它们形成各自的广播域，广播报文不能跨越这些广播域传送。</li><li>从图中还可以看出，各大主机都是不枸泥于所处的物理位置，因为它们既可以挂接在同一个交换机中，也可以挂接在不同的交换机中。</li></ul><p><img src="https://s2.loli.net/2022/06/01/d1eGEjz8xoUqc5I.png"></p><h2 id="虚拟局域网介绍">虚拟局域网介绍</h2><h3 id="现有的共享局域网配置">现有的共享局域网配置</h3><ol type="1"><li>在典型的共享局域网中…<ol type="1"><li>根据用户所插入(plug)的集线器对用户进行物理分组</li><li>路由器分割局域网并提供广播防火墙</li></ol></li><li>在虚拟局域网中<ol type="1"><li>您可以按使用的功能，部门或应用程序对用户进行逻辑分组</li><li>通过专有软件进行配置</li></ol></li></ol><h3 id="lan和vlan之间的差异">LAN和VLAN之间的差异</h3><ol type="1"><li>虚拟局域网<ol type="1"><li>在第2层和第3层工作</li><li>控制网络广播</li><li>允许用户由网络管理员分配。</li><li>提供更严格的网络安全性</li></ol></li></ol><p><img src="https://s2.loli.net/2022/06/01/r6SPz7QcRHVNOsA.png"></p><ul><li>左边是基于地理位置划分成子网(传统局域网)</li><li>VLAN是是通过逻辑位置进行划分</li><li>VLAN1的报文不会发送给VLAN2(虽然连接在一个交换机上)</li></ul><h3 id="vlans-ieee-802.1q">VLANs (IEEE 802.1q)</h3><ol type="1"><li>特点<ol type="1"><li>不限于物理交换机网段的网络设备或用户的<strong>逻辑分组</strong>。</li><li>VLAN中的设备或用户可以按功能，部门，应用程序等进行分组，而<strong>不管其物理网段的位置</strong>如何。</li><li>VLAN<strong>创建一个不限于物理网段</strong>的单个广播域，并且将其视为子网。</li><li>VLAN设置是由网络管理员使用供应商的软件在交换机中完成的。</li></ol></li><li>优点:<ol type="1"><li>限制广播包，提高带宽的利用率。</li><li>增强通信的安全性:其他VLAN用户网络收不到非本VLAN的报文，避免被监听</li><li>创建虚拟工作组：可以一个部门工作的人划分为一个VLAN，这样子即使他移动了办公位置，仍然能够正常办公</li><li>增强网络的健壮性：将一些网络故障限制在一个VLAN中</li></ol></li></ol><h3 id="分组用户">分组用户</h3><ol type="1"><li>VLAN可以从逻辑上将用户划分为不同的子网(广播域)</li><li>广播帧仅在具有相同VLAN ID的一个或多个交换机的端口之间切换。(VLAN ID属于端口)</li><li>可以通过基于以下内容的软件对用户进行逻辑分组：<ol type="1"><li>端口号</li><li>MAC地址</li><li>使用的协议</li><li>使用的应用</li></ol></li></ol><p><strong>没有vlan的网络广播</strong></p><figure><img src="https://s2.loli.net/2022/06/01/7bcYoiEwZaxD26T.png" alt="大家在一个交换机上不可以进行划分"><figcaption aria-hidden="true">大家在一个交换机上不可以进行划分</figcaption></figure><p><strong>划分了vlan的网络广播</strong></p><figure><img src="https://s2.loli.net/2022/06/01/mLV4aJA9doE73Kr.png" alt="各自角色之间单独进行通信，虽然连接的是同一个交换机，如果不在同一个VLAN上，相互之间也不能通信"><figcaption aria-hidden="true">各自角色之间单独进行通信，虽然连接的是同一个交换机，如果不在同一个VLAN上，相互之间也不能通信</figcaption></figure><h3 id="vlan-间通信">VLAN 间通信</h3><p><img src="https://s2.loli.net/2022/06/01/PL1qgDAGbV8ZWn9.png"></p><ul><li>首先127.17.10.21询问网关地址(ARQ)</li><li>路由器帮忙转发(VLAN的交换需要路由器的支持)</li><li>交换机S2的不同端口在不同的VLAN，S1和S2、S1和S3之间是VLAN骨干</li></ul><h3 id="vlan-和第3层转发来控制广播域">VLAN 和第3层转发来控制广播域</h3><figure><img src="https://s2.loli.net/2022/06/01/WTs74gyKUpLhG3S.png" alt="第三层交换机:为每一个网段设置一个SVI(switch virtual interface,虚拟交换机结构，也可以理解为子接口)，通过这个来进行不同网段之间的通信"><figcaption aria-hidden="true">第三层交换机:为每一个网段设置一个SVI(switch virtual interface,虚拟交换机结构，也可以理解为子接口)，通过这个来进行不同网段之间的通信</figcaption></figure><h2 id="vlan的结构">VLAN的结构</h2><h3 id="虚拟局域网通过骨干网backbone">虚拟局域网通过骨干网(BackBone)</h3><p><img src="https://s2.loli.net/2022/06/01/7cXpHV8mWN9gw1x.png"></p><ol type="1"><li>VLAN配置需要支持互连的路由器和交换机之间的骨干数据传输。</li><li>骨干网是用于VLAN间通信的区域</li><li>骨干网应该是高速链路，通常为100Mbps或更高</li><li>BackBone可以跑多个VLAN，是骨干网</li></ol><h3 id="在虚拟局域网中的路由器的作用">在虚拟局域网中的路由器的作用</h3><ol type="1"><li>路由器提供不同VLAN之间的连接</li><li>例如，您有VLAN1和VLAN2。<ol type="1"><li>在交换机内，位于不同VLAN上的用户无法相互通信(VLAN的好处！)</li><li>但是，VLAN1上的用户可以向VLAN2上的用户发送电子邮件，但他们需要路由器才能执行此操作</li></ol></li></ol><h3 id="在虚拟局域网中的帧的使用">在虚拟局域网中的帧的使用</h3><ol type="1"><li>交换机根据帧中的数据做出过滤和转发决策。</li><li>使用了两种技术<ol type="1"><li>帧过滤：检查有关每个帧的特定信息(MAC地址或第3层协议类型),特定的VLAN记录或者映射</li><li>帧标记：在整个网络骨干网中转发时，在每个帧的标题中放置一个唯一的标识符</li></ol></li></ol><p><img src="https://s2.loli.net/2022/06/01/muSnX3sAQpLY7zJ.png"></p><p><strong>Frame Filiter 帧过滤</strong></p><p><img src="https://s2.loli.net/2022/06/01/CJ1VwGv34bKMBZa.png"></p><ul><li>收到帧转发后，发现都不在一个LAN上，然后通过Backbone转发</li><li>Frame Table在交换机上传输</li></ul><p><strong>帧标记</strong></p><ol type="1"><li>帧标记实施过程：<ol type="1"><li>在整个网络骨干网中转发时，在每个帧的标题中放置一个VLAN标识符。</li><li>每个开关都可以理解和检查标识符。</li><li>当帧离开网络骨干网时，交换机会在帧发送到目标终端站之前删除标识符。只和端口绑定，而不影响主机</li></ol></li><li>帧标记在第2层起作用，并且几乎不需要处理或管理开销</li><li>从主机到了交换机端口，交换机端口进行标记，然后进行转发</li></ol><p><img src="https://s2.loli.net/2022/06/01/7WrK1qV6bG93vlP.png"></p><h3 id="frame-tagging-ieee802.1q-and-isl">Frame Tagging – IEEE802.1Q and ISL</h3><ol type="1"><li>IEEE802.1Q:IEEE标准，在标头中插入VLAN的标签以标识所属的VLAN。(帧标记)。</li><li>ISL(Inter-Switch Link)：思科专有。ISL在数据帧的前面添加一个26字节的标头，并在末尾附加一个CRC(4字节)。</li><li>推荐用IEEE802.Q</li><li>标记一般在BackBone上</li></ol><p><img src="https://spricoder.oss-cn-shanghai.aliyuncs.com/2020-Internet-computing/img/lec09/27.png"></p><h2 id="虚拟局域网的实现">虚拟局域网的实现</h2><h3 id="端口虚拟局域网和广播">端口、虚拟局域网和广播</h3><ol type="1"><li>实现VLAN的两种方法<ol type="1"><li>静态的</li><li>动态的</li></ol></li><li>每一个端口绑定给一个VLAN<ol type="1"><li>确保不共享同一VLAN的端口不共享广播。</li><li>确保共享相同VLAN的端口将共享广播。</li></ol></li><li>实现途径:<ol type="1"><li>基于端口的虚拟局域网</li><li>基于MAC地址的虚拟局域网</li><li>基于IP地址的虚拟局域网</li><li>基于上层协议的虚拟局域网</li></ol></li></ol><h3 id="静态vlans">静态VLANS</h3><p><img src="https://s2.loli.net/2022/06/01/qkToyeOV7U1SXur.png"></p><ol type="1"><li>定义：静态VLAN是指将交换机上的端口管理性地分配给VLAN的时间</li><li>优点：<ol type="1"><li>安全，易于配置和监控</li><li>在控制移动的网络中效果很好</li></ol></li><li>端口是写死在交换机的端口上的</li></ol><h3 id="动态vlans">动态VLANS</h3><figure><img src="https://s2.loli.net/2022/06/01/bTP9YEpXS2k7Awh.png" alt="一个服务器来配置VLAN的信息 ， 交换机通过MAC地址或者哪一个协议，指定是哪一个VLAN"><figcaption aria-hidden="true">一个服务器来配置VLAN的信息 ， 交换机通过MAC地址或者哪一个协议，指定是哪一个VLAN</figcaption></figure><ol type="1"><li>当工作站最初连接到未分配的端口时，交换机会检查表中的条目，并使用正确的VLAN动态配置端口</li><li>优点<ol type="1"><li>添加或移动用户时减少管理(更多前期工作)</li><li>集中通知未授权用户</li></ol></li></ol><h3 id="以端口为中心的vlan">以端口为中心的VLAN</h3><p><img src="https://s2.loli.net/2022/06/01/XObNGkP8TVuim3K.png"></p><ul><li>实际的网络是有层次的</li><li>static的物理的接入层(physical Layer)</li><li>不同电脑在一个房间内</li><li>不同房间的不同电脑组成一个VLAN</li><li>路由器网关来处理</li></ul><h3 id="以端口为中心的vlan的优点">以端口为中心的VLAN的优点</h3><ol type="1"><li>同一VLAN中的所有节点都连接到同一路由器接口</li><li>使管理更容易，因为…<ol type="1"><li>通过路由器端口分配用户</li><li>VLAN易于管理。</li><li>提供更高的安全性</li><li>数据包不会"泄漏"到其他域</li></ol></li></ol><h3 id="接入和骨干连接">接入和骨干连接</h3><p><img src="https://s2.loli.net/2022/06/01/U9cm73DJHwuzMSQ.png"></p><ul><li>分为两类:<ol type="1"><li>接入链路:通过一个VLAN报文</li><li>骨干链路:通过多个VLAN报文</li></ol></li></ul><h3 id="访问连接">访问连接</h3><ol type="1"><li>访问连接是仅作为一个VLAN成员的交换机上的连接。</li><li>此VLAN被称为端口的本机VLAN，连接到端口的任何设备都完全不知道VLAN存在</li></ol><h3 id="主干链路">主干链路</h3><ol type="1"><li>主干链路能够支持多个VLAN。</li><li>主干链路通常用于将交换机连接到其他交换机或路由器。</li><li>交换机在快速以太网和千兆位以太网端口上都支持骨干链路。</li><li>也存在访问和骨干链接</li><li>一般Trunk就是BackBone</li></ol><p><img src="https://s2.loli.net/2022/06/01/tJwEC84HWnq69RI.png"></p><blockquote><ol type="1"><li>Sa和Sb上面连接使用单独的线，浪费</li><li>底下使用串行的线，不浪费端口</li></ol></blockquote><ol type="1"><li>骨干是支持多个VLAN的点对点链接</li><li>骨干用于在两个实现VLAN的设备之间创建链接时节省端口</li><li>骨干链路不属于特定的VLAN：充当交换机和路由器之间VLAN的通道。</li><li>可以将骨干链路配置为传输所有VLAN或有限数量的VLAN。</li><li>但是，骨干链路可能具有本地VLAN。</li><li>如果骨干线链路由于任何原因失败，则骨干线的本地VLAN是该骨干线使用的VLAN。</li><li>native VLAN是不发送无标记的信息</li></ol><h3 id="交换机29xx中的配置">交换机29xx中的配置</h3><ol type="1"><li>在Cisco 29xx交换机上配置VLAN时，必须遵循以下准则：<ol type="1"><li>VLAN的最大数量取决于交换机本身。</li><li>VLAN 1是出厂默认VLAN之一。(native VLAN往往是VLAN1，以及广播也是)</li><li>VLAN 1是默认的以太网VLAN。</li><li>思科发现协议(CDP)和VLAN骨干协议(VTP)通告在VLAN 1上发送。</li><li>默认情况下，Catalyst 29xx IP地址在VLAN 1广播域中。</li></ol></li></ol><h3 id="vlan配置">VLAN配置</h3><ol type="1"><li>步骤1：创建VLAN所需的步骤。 如果需要，还可以配置VLAN名称。</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Switch# vlan database</span><br><span class="line">Switch(vlan)# vlan vlan_number</span><br><span class="line">Switch(vlan)# exit</span><br></pre></td></tr></table></figure><ol type="1"><li>步骤2：将VLAN分配给一个或多个接口：</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Switch(config)# interface fastethernet 0/9 Switch(config-if)# switchport access vlan vlan_number</span><br><span class="line"></span><br><span class="line">REASONML</span><br></pre></td></tr></table></figure><h3 id="添加vlan示例">添加VLAN示例</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cat2950#vlan database</span><br><span class="line">cat2950(vlan)#vlan 9 name switchlab90</span><br><span class="line">VLAN 9 added:</span><br><span class="line">   Name: switchlab90</span><br><span class="line">cat2950(vlan)#?</span><br><span class="line">VLAN database editing buffer manipulation commands:</span><br><span class="line">    abort Exit mode without applying the changes</span><br><span class="line">    apply Apply current changes and bump revision number</span><br><span class="line">    exit Apply changes, bump revision number, and exit mode</span><br><span class="line">    reset Abandon current changes and reread current database Adding a VLAN Example</span><br><span class="line">cat2950(config)#interface fa 0/2</span><br><span class="line">cat2950(config-if)# switchport access vlan 9</span><br></pre></td></tr></table></figure><h3 id="验证vlan">验证VLAN</h3><ol type="1"><li><code>Switch# show vlan [vlanid]</code></li></ol><p><a target="_blank" rel="noopener" href="https://spricoder.oss-cn-shanghai.aliyuncs.com/2020-Internet-computing/img/lec09/33.png"><img src="https://spricoder.oss-cn-shanghai.aliyuncs.com/2020-Internet-computing/img/lec09/33.png" alt="img"></a></p><blockquote><p>剩下的是默认VLAN</p></blockquote><h3 id="删除vlan">删除VLAN</h3><ol type="1"><li>删除VLAN后，分配给该VLAN的所有端口都将变为非活动状态。 但是，端口将一直与删除的VLAN关联，直到分配给新的VLAN。</li><li><code>switch(vlan)# no vlan vlanid [name /vlan-name]</code></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cat2950(vlan)#no vlan 9</span><br><span class="line">Deleting VLAN 9...</span><br><span class="line">cat2950(vlan)#exit</span><br><span class="line">APPLY completed.</span><br><span class="line">Exiting....</span><br><span class="line">cat2950#</span><br></pre></td></tr></table></figure><h2 id="在局域网之间的路由">在局域网之间的路由</h2><p><img src="https://s2.loli.net/2022/06/01/nuNvt48FaCWDd1k.png"></p><ol type="1"><li>每个端口连接一个VLAN，每个IP和一个VLAN连接</li><li>如下图，我们使用串口线，物理上是一个一个接口，划分成多个IP和子接口</li></ol><p><img src="https://s2.loli.net/2022/06/01/K51nrHsp8YTwAOz.jpg"></p><ul><li>对比如下:接入方式不同</li></ul><p><img src="https://s2.loli.net/2022/06/01/HuFBDXOctYKCQ7I.png"></p><h3 id="子接口">子接口</h3><p><img src="https://s2.loli.net/2022/06/01/jYkndq98TNP24bF.png"></p><ol type="1"><li>物理上一个，划分成Fa0/1、Fa0/2和Fa/3</li><li>涉及到的是单臂路由</li></ol><h3 id="配置vlan间路由">配置VLAN间路由</h3><ol type="1"><li>Step1:识别界面.<code>Router(config)#interface fastethernet port-number. subinterface-number</code></li><li>Step2:定义VLAN封装.(一般用dot1q)<code>Router(config-if)#encapsulation dot1q vlan-number</code></li><li>Step3:为接口分配IP地址 <code>Router(config-if)#ip address ip-address subnet-mask</code></li></ol><h3 id="配置vlan间路由-1">配置VLAN间路由</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Sydney(config)#interface FastEthernet 0/0 </span><br><span class="line">Sydney(config-if)#full duplex 全双工</span><br><span class="line">Sydney(config-if)#no shut</span><br><span class="line">Sydney(config-if)#interface FastEthernet 0/0.1</span><br><span class="line"></span><br><span class="line">Sydney(config-subif)#encapsulation 802.1q 1</span><br><span class="line">Sydney(config-subif)#ip address 192.168.1.1 255.255.255.0</span><br><span class="line">Sydney(config-if)#interface FastEthernet 0/0.2</span><br><span class="line"></span><br><span class="line">Sydney(config-subif)#encapsulation 802.1q 20</span><br><span class="line">Sydney(config-subif)#ip address 192.168.2.1 255.255.255.0</span><br><span class="line">Sydney(config-if)#interface FastEthernet 0/0.3</span><br><span class="line"></span><br><span class="line">Sydney(config-subif)#encapsulation 802.1q 30</span><br><span class="line">Sydney(config-subif)#ip address 192.168.3.1 255.255.255.0</span><br></pre></td></tr></table></figure><ol type="1"><li>如果是Trunk Link:应该使用交叉线，而不是直通线</li><li>如果是Access Link:直通线</li></ol><h1 id="vlan题目备注">VLAN题目备注</h1><ol type="1"><li>同一VLAN中的两台主机可以跨越多台交换机</li><li>必须是第三层及以上的交换机才能用来构建VLAN</li></ol></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">胡小小小小睿</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://little-hurui.cloud/2022/05/31/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2%E5%92%8Cvlan/">http://little-hurui.cloud/2022/05/31/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2%E5%92%8Cvlan/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://little-hurui.cloud" target="_blank">投降输一半</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a><a class="post-meta__tags" href="/tags/%E4%BA%92%E8%81%94%E7%BD%91%E8%AE%A1%E7%AE%97/">互联网计算</a></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2022/04/20/lEudvTzOcIBmCiQ.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://s2.loli.net/2022/04/19/RFQ7a3WzipEBlS2.jpg" target="_blank"><img class="post-qr-code-img" src="https://s2.loli.net/2022/04/19/RFQ7a3WzipEBlS2.jpg" alt="wechat"></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://s2.loli.net/2022/04/19/faP7b2XxJlQqVrp.jpg" target="_blank"><img class="post-qr-code-img" src="https://s2.loli.net/2022/04/19/faP7b2XxJlQqVrp.jpg" alt="alipay"></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/06/01/WANS/"><img class="prev-cover" src="https://s2.loli.net/2022/04/20/uwST9JbjlZxa3Q5.jpg" onerror='onerror=null,src="https://s2.loli.net/2022/04/19/zHg7f51jDBVOcR2.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">WANS</div></div></a></div><div class="next-post pull-right"><a href="/2022/05/27/Routing-and-Routers/"><img class="next-cover" src="https://s2.loli.net/2022/04/20/7NqBmPG2CWAycbg.jpg" onerror='onerror=null,src="https://s2.loli.net/2022/04/19/zHg7f51jDBVOcR2.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Routing and Routers</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/05/26/Routing-Protocols/" title="Routing Protocols"><img class="cover" src="https://s2.loli.net/2022/04/21/OxowE7mPhqfAKyU.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-26</div><div class="title">Routing Protocols</div></div></a></div><div><a href="/2022/05/27/Routing-and-Routers/" title="Routing and Routers"><img class="cover" src="https://s2.loli.net/2022/04/20/7NqBmPG2CWAycbg.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-27</div><div class="title">Routing and Routers</div></div></a></div><div><a href="/2022/05/25/%E5%BA%94%E7%94%A8%E5%B1%82/" title="应用层"><img class="cover" src="https://s2.loli.net/2022/04/22/6IMRhjNnYm1coS7.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-25</div><div class="title">应用层</div></div></a></div><div><a href="/2022/05/26/%E8%B7%AF%E7%94%B1%E5%99%A8%E5%92%8C%E7%BD%91%E7%BB%9C/" title="路由器和网络"><img class="cover" src="https://s2.loli.net/2022/04/20/lEudvTzOcIBmCiQ.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-26</div><div class="title">路由器和网络</div></div></a></div><div><a href="/2022/05/24/%E8%BF%90%E8%BE%93%E5%B1%82/" title="运输层"><img class="cover" src="https://s2.loli.net/2022/04/20/QeCmhpyqNxo38lK.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-24</div><div class="title">运输层</div></div></a></div><div><a href="/2022/06/01/WANS/" title="WANS"><img class="cover" src="https://s2.loli.net/2022/04/20/uwST9JbjlZxa3Q5.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-01</div><div class="title">WANS</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s2.loli.net/2022/04/20/iVOmaCTznfybv2A.jpg" onerror='this.onerror=null,this.src="https://s2.loli.net/2022/04/19/zHg7f51jDBVOcR2.jpg"' alt="avatar"></div><div class="author-info__name">胡小小小小睿</div><div class="author-info__description">Stay hungry Stay foolish</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">126</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">72</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Freeeeeeeeedom"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Freeeeeeeeedom" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://space.bilibili.com/629788196" target="_blank" title="Bilibili"><i class="fa fa-bold"></i></a><a class="social-icon" href="https://www.zhihu.com/people/over-47-40" target="_blank" title="Zhihu"><i class="fa fa-fighter-jet"></i></a><a class="social-icon" href="https://leetcode-cn.com/u/dega-vu/" target="_blank" title="Leetcode"><i class="fa fa-check-square"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">I'm free, gone with wind.</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2-%E4%B8%8E-vlan"><span class="toc-number">1.</span> <span class="toc-text">局域网交换 与 vlan</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%A4%E6%8D%A2%E6%9C%BA"><span class="toc-number">2.</span> <span class="toc-text">交换机</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD"><span class="toc-number">2.1.</span> <span class="toc-text">交换机基本功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E7%A7%B0%E4%BA%A4%E6%8D%A2-symmetric-switching"><span class="toc-number">2.2.</span> <span class="toc-text">对称交换 Symmetric Switching</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%9E%E5%AF%B9%E7%A7%B0%E4%BA%A4%E6%8D%A2-asymmetric-switching"><span class="toc-number">2.3.</span> <span class="toc-text">非对称交换 Asymmetric Switching</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E7%BC%93%E5%86%B2"><span class="toc-number">2.3.1.</span> <span class="toc-text">内存缓冲</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%A4%E6%8D%A2%E6%96%B9%E5%BC%8F"><span class="toc-number">2.4.</span> <span class="toc-text">交换方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%82%A8%E5%AD%98%E8%BD%AC%E5%8F%91-store-and-forward-%E7%BD%91%E6%A1%A5-%E8%B7%AF%E7%94%B1%E5%99%A8%E7%AD%89%E9%80%9A%E8%BF%87%E8%BD%AF%E4%BB%B6%E7%9A%84%E8%AE%BE%E5%A4%87"><span class="toc-number">2.4.1.</span> <span class="toc-text">储存转发 (Store and Forward ,网桥 路由器等通过软件的设备)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cut-through-%E7%9B%B4%E9%80%9A"><span class="toc-number">2.4.2.</span> <span class="toc-text">Cut through 直通</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#segment-free-switching-%E6%97%A0%E7%A2%8E%E7%89%87%E8%BD%AC%E5%8F%91"><span class="toc-number">2.4.3.</span> <span class="toc-text">Segment free Switching 无碎片转发</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA"><span class="toc-number">2.5.</span> <span class="toc-text">第二层交换机</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA"><span class="toc-number">2.6.</span> <span class="toc-text">第三层交换机</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA"><span class="toc-number">2.7.</span> <span class="toc-text">第四层交换机</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA%E6%80%BB%E7%BB%93"><span class="toc-number">2.8.</span> <span class="toc-text">多层交换机总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E6%A0%91%E5%8D%8F%E8%AE%AEstp-the-spanning-tree-protocol"><span class="toc-number">3.</span> <span class="toc-text">生成树协议(STP, The Spanning-Tree Protocol)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9E%E8%B7%AF"><span class="toc-number">3.1.</span> <span class="toc-text">回路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%97%E4%BD%99%E9%80%A0%E6%88%90%E4%BA%86%E8%B7%AF%E7%94%B1%E5%9B%9E%E8%B7%AF"><span class="toc-number">3.2.</span> <span class="toc-text">冗余造成了路由回路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%B1%82%E8%B7%AF%E7%94%B1%E5%9B%9E%E8%B7%AF"><span class="toc-number">3.3.</span> <span class="toc-text">第二层路由回路</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%B1%82%E8%B7%AF%E7%94%B1%E5%9B%9E%E8%B7%AF-%E6%B3%9B%E6%B4%AA%E5%8D%95%E6%92%AD%E5%B8%A7"><span class="toc-number">3.3.1.</span> <span class="toc-text">第二层路由回路-泛洪单播帧</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E6%A0%91%E5%8D%8F%E8%AE%AE-%E7%BB%BC%E8%BF%B0"><span class="toc-number">3.4.</span> <span class="toc-text">生成树协议 综述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#stp%E5%86%B3%E7%AD%96%E9%A1%BA%E5%BA%8Fseqence"><span class="toc-number">3.4.1.</span> <span class="toc-text">STP决策顺序(Seqence)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bpdus-bridge-protocol-data-unit"><span class="toc-number">3.4.2.</span> <span class="toc-text">BPDUs (Bridge Protocol Data Unit)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#stp%E7%9A%84bpdu%E5%B8%A7"><span class="toc-number">3.4.3.</span> <span class="toc-text">STP的BPDU帧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bridge-identificationbid"><span class="toc-number">3.4.4.</span> <span class="toc-text">Bridge Identification&#x2F;BID</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%89%E4%B8%BE%E6%A0%B9%E4%BA%A4%E6%8D%A2%E6%9C%BA"><span class="toc-number">3.4.5.</span> <span class="toc-text">选举根交换机</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E5%BE%84%E4%BB%A3%E4%BB%B7-cost"><span class="toc-number">3.5.</span> <span class="toc-text">路径代价 Cost</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#five-stp-states-5%E4%B8%AAstp%E7%8A%B6%E6%80%81"><span class="toc-number">3.6.</span> <span class="toc-text">Five STP States 5个STP状态</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9D%E5%A7%8Bstp%E6%94%B6%E6%95%9B"><span class="toc-number">3.7.</span> <span class="toc-text">初始STP收敛</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A41%E6%A0%B9%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%86%B3%E5%AE%9A"><span class="toc-number">3.7.1.</span> <span class="toc-text">步骤1：根交换机决定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A42%E9%80%89%E6%8B%A9%E6%A0%B9%E7%AB%AF%E5%8F%A3"><span class="toc-number">3.7.2.</span> <span class="toc-text">步骤2：选择根端口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A43%E9%80%89%E6%8B%A9%E7%BD%91%E6%AE%B5%E7%9A%84%E6%8C%87%E5%AE%9A%E7%AB%AF%E5%8F%A3i"><span class="toc-number">3.7.3.</span> <span class="toc-text">步骤3：选择网段的指定端口(I)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#vlan-virtual-local-area-network-%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91"><span class="toc-number">4.</span> <span class="toc-text">VLAN (Virtual Local Area Network 虚拟局域网)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E5%BC%95%E5%85%A5vlan"><span class="toc-number">4.1.</span> <span class="toc-text">为什么引入VLAN？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vlan%E5%8F%AF%E4%BB%A5%E4%B8%8D%E9%80%9A%E8%BF%87%E8%B7%AF%E7%94%B1%E5%99%A8%E5%B0%B1%E9%9A%94%E7%A6%BB%E5%B9%BF%E6%92%AD%E5%9F%9F%E5%90%97"><span class="toc-number">4.2.</span> <span class="toc-text">VLAN可以不通过路由器就隔离广播域吗？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BB%8B%E7%BB%8D"><span class="toc-number">4.3.</span> <span class="toc-text">虚拟局域网介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%B0%E6%9C%89%E7%9A%84%E5%85%B1%E4%BA%AB%E5%B1%80%E5%9F%9F%E7%BD%91%E9%85%8D%E7%BD%AE"><span class="toc-number">4.3.1.</span> <span class="toc-text">现有的共享局域网配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lan%E5%92%8Cvlan%E4%B9%8B%E9%97%B4%E7%9A%84%E5%B7%AE%E5%BC%82"><span class="toc-number">4.3.2.</span> <span class="toc-text">LAN和VLAN之间的差异</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vlans-ieee-802.1q"><span class="toc-number">4.3.3.</span> <span class="toc-text">VLANs (IEEE 802.1q)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E7%94%A8%E6%88%B7"><span class="toc-number">4.3.4.</span> <span class="toc-text">分组用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vlan-%E9%97%B4%E9%80%9A%E4%BF%A1"><span class="toc-number">4.3.5.</span> <span class="toc-text">VLAN 间通信</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vlan-%E5%92%8C%E7%AC%AC3%E5%B1%82%E8%BD%AC%E5%8F%91%E6%9D%A5%E6%8E%A7%E5%88%B6%E5%B9%BF%E6%92%AD%E5%9F%9F"><span class="toc-number">4.3.6.</span> <span class="toc-text">VLAN 和第3层转发来控制广播域</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vlan%E7%9A%84%E7%BB%93%E6%9E%84"><span class="toc-number">4.4.</span> <span class="toc-text">VLAN的结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91%E9%80%9A%E8%BF%87%E9%AA%A8%E5%B9%B2%E7%BD%91backbone"><span class="toc-number">4.4.1.</span> <span class="toc-text">虚拟局域网通过骨干网(BackBone)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91%E4%B8%AD%E7%9A%84%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">4.4.2.</span> <span class="toc-text">在虚拟局域网中的路由器的作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91%E4%B8%AD%E7%9A%84%E5%B8%A7%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">4.4.3.</span> <span class="toc-text">在虚拟局域网中的帧的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#frame-tagging-ieee802.1q-and-isl"><span class="toc-number">4.4.4.</span> <span class="toc-text">Frame Tagging – IEEE802.1Q and ISL</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-number">4.5.</span> <span class="toc-text">虚拟局域网的实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91%E5%92%8C%E5%B9%BF%E6%92%AD"><span class="toc-number">4.5.1.</span> <span class="toc-text">端口、虚拟局域网和广播</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%99%E6%80%81vlans"><span class="toc-number">4.5.2.</span> <span class="toc-text">静态VLANS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81vlans"><span class="toc-number">4.5.3.</span> <span class="toc-text">动态VLANS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A5%E7%AB%AF%E5%8F%A3%E4%B8%BA%E4%B8%AD%E5%BF%83%E7%9A%84vlan"><span class="toc-number">4.5.4.</span> <span class="toc-text">以端口为中心的VLAN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A5%E7%AB%AF%E5%8F%A3%E4%B8%BA%E4%B8%AD%E5%BF%83%E7%9A%84vlan%E7%9A%84%E4%BC%98%E7%82%B9"><span class="toc-number">4.5.5.</span> <span class="toc-text">以端口为中心的VLAN的优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A5%E5%85%A5%E5%92%8C%E9%AA%A8%E5%B9%B2%E8%BF%9E%E6%8E%A5"><span class="toc-number">4.5.6.</span> <span class="toc-text">接入和骨干连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E8%BF%9E%E6%8E%A5"><span class="toc-number">4.5.7.</span> <span class="toc-text">访问连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E5%B9%B2%E9%93%BE%E8%B7%AF"><span class="toc-number">4.5.8.</span> <span class="toc-text">主干链路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%A4%E6%8D%A2%E6%9C%BA29xx%E4%B8%AD%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">4.5.9.</span> <span class="toc-text">交换机29xx中的配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vlan%E9%85%8D%E7%BD%AE"><span class="toc-number">4.5.10.</span> <span class="toc-text">VLAN配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0vlan%E7%A4%BA%E4%BE%8B"><span class="toc-number">4.5.11.</span> <span class="toc-text">添加VLAN示例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81vlan"><span class="toc-number">4.5.12.</span> <span class="toc-text">验证VLAN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4vlan"><span class="toc-number">4.5.13.</span> <span class="toc-text">删除VLAN</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E5%B1%80%E5%9F%9F%E7%BD%91%E4%B9%8B%E9%97%B4%E7%9A%84%E8%B7%AF%E7%94%B1"><span class="toc-number">4.6.</span> <span class="toc-text">在局域网之间的路由</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E6%8E%A5%E5%8F%A3"><span class="toc-number">4.6.1.</span> <span class="toc-text">子接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEvlan%E9%97%B4%E8%B7%AF%E7%94%B1"><span class="toc-number">4.6.2.</span> <span class="toc-text">配置VLAN间路由</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEvlan%E9%97%B4%E8%B7%AF%E7%94%B1-1"><span class="toc-number">4.6.3.</span> <span class="toc-text">配置VLAN间路由</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#vlan%E9%A2%98%E7%9B%AE%E5%A4%87%E6%B3%A8"><span class="toc-number">5.</span> <span class="toc-text">VLAN题目备注</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/06/19/%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80%E5%A4%8D%E4%B9%A0/" title="数据管理基础复习"><img src="https://s2.loli.net/2022/04/20/dqpEQiFjBhuYc4T.jpg" onerror='this.onerror=null,this.src="https://s2.loli.net/2022/04/19/zHg7f51jDBVOcR2.jpg"' alt="数据管理基础复习"></a><div class="content"><a class="title" href="/2022/06/19/%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80%E5%A4%8D%E4%B9%A0/" title="数据管理基础复习">数据管理基础复习</a><time datetime="2022-06-19T08:58:31.000Z" title="发表于 2022-06-19 16:58:31">2022-06-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/18/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%85%A5%E9%97%A8/" title="设计模式入门"><img src="https://s2.loli.net/2022/04/20/7NqBmPG2CWAycbg.jpg" onerror='this.onerror=null,this.src="https://s2.loli.net/2022/04/19/zHg7f51jDBVOcR2.jpg"' alt="设计模式入门"></a><div class="content"><a class="title" href="/2022/06/18/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%85%A5%E9%97%A8/" title="设计模式入门">设计模式入门</a><time datetime="2022-06-18T06:26:49.000Z" title="发表于 2022-06-18 14:26:49">2022-06-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/12/%E4%B8%AD%E5%9B%BD%E8%BF%91%E4%BB%A3%E5%8F%B2%E7%BA%B2%E8%A6%81/" title="中国近代史纲要"><img src="https://s2.loli.net/2022/04/22/tvuEUc2pG7MDw1B.jpg" onerror='this.onerror=null,this.src="https://s2.loli.net/2022/04/19/zHg7f51jDBVOcR2.jpg"' alt="中国近代史纲要"></a><div class="content"><a class="title" href="/2022/06/12/%E4%B8%AD%E5%9B%BD%E8%BF%91%E4%BB%A3%E5%8F%B2%E7%BA%B2%E8%A6%81/" title="中国近代史纲要">中国近代史纲要</a><time datetime="2022-06-12T06:02:20.000Z" title="发表于 2022-06-12 14:02:20">2022-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/09/%E8%BD%AF%E5%B7%A5%E4%BA%8C%E5%A4%8D%E4%B9%A0/" title="软工二复习"><img src="https://s2.loli.net/2022/04/21/vpPKTS2HgmCDx7Y.jpg" onerror='this.onerror=null,this.src="https://s2.loli.net/2022/04/19/zHg7f51jDBVOcR2.jpg"' alt="软工二复习"></a><div class="content"><a class="title" href="/2022/06/09/%E8%BD%AF%E5%B7%A5%E4%BA%8C%E5%A4%8D%E4%B9%A0/" title="软工二复习">软工二复习</a><time datetime="2022-06-09T06:02:44.000Z" title="发表于 2022-06-09 14:02:44">2022-06-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/02/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91/" title="微信小程序开发"><img src="https://s2.loli.net/2022/04/22/vYHZwsUNofe3AXT.jpg" onerror='this.onerror=null,this.src="https://s2.loli.net/2022/04/19/zHg7f51jDBVOcR2.jpg"' alt="微信小程序开发"></a><div class="content"><a class="title" href="/2022/06/02/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91/" title="微信小程序开发">微信小程序开发</a><time datetime="2022-06-02T11:16:14.000Z" title="发表于 2022-06-02 19:16:14">2022-06-02</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By 胡小小小小睿</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> 数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.css"><script>document.querySelectorAll("#article-container span.katex-display").forEach(a=>{btf.wrap(a,"div",{class:"katex-wrap"})})</script><script>function loadValine(){function n(){new Valine(Object.assign({el:"#vcomment",appId:"mhyGN57MG6G9YJ3rtTn90n4c-gzGzoHsz",appKey:"D3FU0mepwLhB8BK48kSAaOLx",avatar:"monsterid",serverURLs:"",emojiMaps:"",path:window.location.pathname,visitor:!0},null))}"function"==typeof Valine?n():getScript("https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js").then(n)}function loadOtherComment(){loadValine()}setTimeout(loadValine,0)</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zindex="-1" mobile="false" data-click="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>